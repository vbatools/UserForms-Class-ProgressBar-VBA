# Класс VBA Progress Bar

Класс VBA для отображения настраиваемой полосы прогресса во время длительных операций в Excel или других приложениях Office.

## Обзор

Класс `clsProgresBar` предоставляет простой в использовании интерфейс для отображения прогресса во время длительных операций. Он имеет чистый, настраиваемый интерфейс с поддержкой двойных сообщений, визуальных индикаторов и отмены пользователем.

## Возможности

- **Двойное отображение сообщений**: Верхняя и нижняя области сообщений для детальной информации о прогрессе
- **Визуальный индикатор прогресса**: Анимированная линия прогресса с настраиваемыми цветами
- **Отмена пользователем**: Поддержка отмены операций клавишей Esc
- **Настраиваемый внешний вид**: Настраиваемые символы, цвета и размеры
- **Оптимизированная производительность**: Эффективные обновления для минимизации задержек интерфейса
- **Обработка ошибок**: Комплексное управление ошибками и отчеты

## Установка

1. Импортируйте модуль класса `clsProgresBar.cls` ваш проект VBA
2. Импортируйте модуль формы `frmProgresBar_2.frm` в ваш проект VBA
3. Используйте класс в вашем коде, как показано в примерах использования

## Использование

### Базовое использование

```vba
Sub ExampleUsage()
    Dim oProg As clsProgresBar
    Set oProg = New clsProgresBar
    
    ' Инициализировать полосу прогресса
    oProg.Initialize "Обработка данных...", "Обработка данных", True, ">"
    
    ' Симуляция длительной операции
    Dim i As Long
    For i = 1 To 100
        ' Обновить полосу прогресса
        oProg.Update i, 1000, "Обработка элемента " & i
    Next i
    
    Set oProg = Nothing
End Sub
```

### Расширенное использование

```vba
Sub AdvancedExample()
    Dim oProg As clsProgresBar
    Set oProg = New clsProgresBar
    
    ' Инициализировать с настраиваемыми параметрами
    oProg.Initialize "Загрузка файлов...", "Загрузчик файлов", True, "*"
    
    ' Настроить цвета
    oProg.lProgressColor = RGB(0, 128, 255) ' Синяя линия прогресса
    oProg.lPictColor = RGB(255, 165, 0)     ' Оранжевый символ
    
    ' Изменить размер полосы прогресса
    oProg.Resize 600, 40, 30
    
    ' Обработка с обновлениями прогресса
    Dim i As Long
    For i = 1 To 500
        oProg.Update i, 500, "Файл " & i & " из 50"
        
        ' Добавить задержку для симуляции работы
        Application.Wait Now + TimeValue("0:00:01")
    Next i
    
    Set oProg = Nothing
End Sub
```

## Справочник API

### Методы

#### `Initialize(sMessage As String, sHeader As String, Optional bShowPict As Boolean = False, Optional sPict As String = vbNullString)`
Инициализирует полосу прогресса с указанными параметрами.

- `sMessage`: Сообщение для отображения в верхней области сообщений
- `sHeader`: Текст заголовка формы
- `bShowPict`: Показывать ли символ/картинку индикатора
- `sPict`: Символ/картинка для отображения

#### `Update(i As Long, iCount As Long, sMsg As String)`
Обновляет полосу прогресса новыми значениями.

- `i`: Номер текущего шага
- `iCount`: Общее количество шагов
- `sMsg`: Сообщение для отображения в нижней области сообщений

#### `Resize(Width As Double, HeightMessage As Double, HeightMessageTwo As Double)`
Изменяет размер полосы прогресса.

- `Width`: Ширина формы
- `HeightMessage`: Высота верхнего сообщения
- `HeightMessageTwo`: Высота нижнего сообщения

### Свойства

#### `Header As String`
Получает или устанавливает текст заголовка формы.

#### `MessageTop As String`
Получает или устанавливает текст верхнего сообщения.

#### `MessageBottom As String`
Получает или устанавливает текст нижнего сообщения.

#### `ShowPict As Boolean`
Получает или устанавливает видимость символа/картинки индикатора.

#### `sPict As String`
Получает или устанавливает текст символа/картинки.

#### `lPictColor As Long`
Получает или устанавливает цвет символа/картинки индикатора.

#### `lProgressColor As Long`
Получает или устанавливает цвет линии прогресса.

## Обработка ошибок

Класс включает комплексную обработку ошибок:

- Деление на ноль в методе Update вызывает ошибку 1001
- Недопустимые параметры в методе Resize вызывают ошибку 1002

## Настройка

Полосу прогресса можно настроить несколькими способами:

- Цвета для линии прогресса и символа индикатора
- Размеры и габариты
- Видимость символа индикатора
- Текст заголовка и сообщений
- Символ индикатора прогресса

## Производительность

Реализация оптимизирована для производительности за счет:

- Обновления элементов интерфейса только при изменении значений
- Эффективных строковых операций
- Минимального использования дорогих операций во время обновлений

## Лицензия

Apache License 2.0